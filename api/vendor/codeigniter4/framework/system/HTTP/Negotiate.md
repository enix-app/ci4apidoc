


 



<table>
<tr>
<td style="width:100%"><em>framework/system/HTTP/Negotiate.php</em></td>
<td><a href="../../../../../../api/index.md">index</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Message.md">prev</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/RedirectResponse.md">next</a></td>
</tr>
</table>







# CodeIgniter\HTTP 
<table style="text-align:left">
<tr><th>namespace</th><td>CodeIgniter\HTTP</td></tr>
</table>

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
CodeIgniter
</td></tr>
</table>

<table>
<tr><td>
An open source application development framework for PHP

This content is released under the MIT License (MIT)

Copyright (c) 2014-2019 British Columbia Institute of Technology
Copyright (c) 2019-2020 CodeIgniter Foundation

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
</td></tr>
</table>

</details>



<table style="text-align:left">
<tr style="vertical-align:top;">
<th>package</th>
<td>CodeIgniter
</td>
</tr>
<tr style="vertical-align:top;">
<th>author</th>
<td>CodeIgniter Dev Team
</td>
</tr>
<tr style="vertical-align:top;">
<th>copyright</th>
<td>2019-2020 CodeIgniter Foundation
</td>
</tr>
<tr style="vertical-align:top;">
<th>license</th>
<td><a href="https://opensource.org/licenses/MIT">https://opensource.org/licenses/MIT</a>	MIT License
</td>
</tr>
<tr style="vertical-align:top;">
<th>link</th>
<td><a href="https://codeigniter.com">https://codeigniter.com</a>

</td>
</tr>
<tr style="vertical-align:top;">
<th>filesource</th>
<td>framework/system/HTTP/Negotiate.php
</td>
</tr>
</table>

 

<details>
<summary style="margin-bottom:12px;"><strong>Members</strong></summary>
<table>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/CLIRequest.md">CodeIgniter\HTTP\CLIRequest</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/CURLRequest.md">CodeIgniter\HTTP\CURLRequest</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/ContentSecurityPolicy.md">CodeIgniter\HTTP\ContentSecurityPolicy</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/DownloadResponse.md">CodeIgniter\HTTP\DownloadResponse</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Exceptions/HTTPException.md">CodeIgniter\HTTP\Exceptions\HTTPException</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Files/FileCollection.md">CodeIgniter\HTTP\Files\FileCollection</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Files/UploadedFile.md">CodeIgniter\HTTP\Files\UploadedFile</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Files/UploadedFileInterface.md">CodeIgniter\HTTP\Files\UploadedFileInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Header.md">CodeIgniter\HTTP\Header</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/IncomingRequest.md">CodeIgniter\HTTP\IncomingRequest</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Message.md">CodeIgniter\HTTP\Message</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Negotiate.md">CodeIgniter\HTTP\Negotiate</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/RedirectResponse.md">CodeIgniter\HTTP\RedirectResponse</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Request.md">CodeIgniter\HTTP\Request</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/RequestInterface.md">CodeIgniter\HTTP\RequestInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Response.md">CodeIgniter\HTTP\Response</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/ResponseInterface.md">CodeIgniter\HTTP\ResponseInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/URI.md">CodeIgniter\HTTP\URI</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/UserAgent.md">CodeIgniter\HTTP\UserAgent</a></td></tr>
</table>
</details>



 
 ## Uses

<table style="text-align:left;">
<tr>
<td>
<a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Exceptions/HTTPException.md"><strong>CodeIgniter\HTTP\Exceptions\HTTPException</strong></a>
</td>
<td>HTTPException</td>
</tr>
</table>



 
## CodeIgniter\HTTP\Negotiate

<table style="text-align:left">
<tr><th>Class</th><td>Negotiate</td></tr>
<tr><th>Fully Qualified Name</th><td>CodeIgniter\HTTP\Negotiate</td></tr>
</table>


<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Class Negotiate
</td></tr>
</table>

<table>
<tr><td>
Provides methods to negotiate with the HTTP headers to determine the best
type match between what the application supports and what the requesting
getServer wants.
</td></tr>
</table>

</details>



<table style="text-align:left">
<tr style="vertical-align:top;">
<th>package</th>
<td>CodeIgniter\HTTP
</td>
</tr>
</table>



### Summary


<table style="text-align:left;">
<tr>
<th>Name</th>
<th>Element</th>
<th>Modifier</th>
<th>Description</th>
</tr>

<tr>
<th><a href="#request"><strong>request</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Request</td>
</tr>

<tr>
<th><a href="#__construct"><strong>__construct</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Constructor</td>
</tr>
<tr>
<th><a href="#setRequest"><strong>setRequest</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Stores the request instance to grab the headers from.</td>
</tr>
<tr>
<th><a href="#media"><strong>media</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Determines the best content-type to use based on the $supported
types the application says it supports, and the types requested
by the client.</td>
</tr>
<tr>
<th><a href="#charset"><strong>charset</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Determines the best charset to use based on the $supported
types the application says it supports, and the types requested
by the client.</td>
</tr>
<tr>
<th><a href="#encoding"><strong>encoding</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Determines the best encoding type to use based on the $supported
types the application says it supports, and the types requested
by the client.</td>
</tr>
<tr>
<th><a href="#language"><strong>language</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Determines the best language to use based on the $supported
types the application says it supports, and the types requested
by the client.</td>
</tr>
<tr>
<th><a href="#getBestMatch"><strong>getBestMatch</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Does the grunt work of comparing any of the app-supported values
against a given Accept* header string.</td>
</tr>
<tr>
<th><a href="#parseHeader"><strong>parseHeader</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Parses an Accept* header into it&#039;s multiple values.</td>
</tr>
<tr>
<th><a href="#match"><strong>match</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Match-maker</td>
</tr>
<tr>
<th><a href="#matchParameters"><strong>matchParameters</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Checks two Accept values with matching &#039;values&#039; to see if their
&#039;params&#039; are the same.</td>
</tr>
<tr>
<th><a href="#matchTypes"><strong>matchTypes</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Compares the types/subtypes of an acceptable Media type and
the supported string.</td>
</tr>
<tr>
<th><a href="#matchLocales"><strong>matchLocales</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Will match locales against their broader pairs, so that fr-FR would
match a supported localed of fr</td>
</tr>

</table>





### Properties


<hr>

#### $request

```php
protected $request;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Request
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>\CodeIgniter\HTTP\RequestInterface<br>\CodeIgniter\HTTP\IncomingRequest
</td>
</tr>
</table>







### Methods


<hr>

#### __construct()

```php
public function __construct(RequestInterface $request = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Constructor
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$request</code></td>
<td><em>\CodeIgniter\HTTP\RequestInterface<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 7 lines (71 - 77)</small></summary>

```php
public function __construct(RequestInterface $request = null)
{
	if (! is_null($request))
	{
		$this->request = $request;
	}
}
```

</details>


<hr>

#### setRequest()

```php
public function setRequest(RequestInterface $request)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Stores the request instance to grab the headers from.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$request</code></td>
<td><em>\RequestInterface
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (88 - 93)</small></summary>

```php
public function setRequest(RequestInterface $request)
{
	$this->request = $request;

	return $this;
}
```

</details>


<hr>

#### media()

```php
public function media(array $supported, bool $strictMatch = false) : string
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Determines the best content-type to use based on the $supported
types the application says it supports, and the types requested
by the client.
</td></tr>
</table>

<table>
<tr><td>
If no match is found, the first, highest-ranking client requested
type is returned.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$supported</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$strictMatch</code></td>
<td><em>bool
</em></td>
<td>false</td>
<td>If TRUE, will return an empty string when no match found.
If FALSE, will return the first supported element.</td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 4 lines (111 - 114)</small></summary>

```php
public function media(array $supported, bool $strictMatch = false): string
{
	return $this->getBestMatch($supported, $this->request->getHeaderLine('accept'), true, $strictMatch);
}
```

</details>


<hr>

#### charset()

```php
public function charset(array $supported) : string
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Determines the best charset to use based on the $supported
types the application says it supports, and the types requested
by the client.
</td></tr>
</table>

<table>
<tr><td>
If no match is found, the first, highest-ranking client requested
type is returned.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$supported</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 13 lines (130 - 142)</small></summary>

```php
public function charset(array $supported): string
{
	$match = $this->getBestMatch($supported, $this->request->getHeaderLine('accept-charset'), false, true);

	// If no charset is shown as a match, ignore the directive
	// as allowed by the RFC, and tell it a default value.
	if (empty($match))
	{
		return 'utf-8';
	}

	return $match;
}
```

</details>


<hr>

#### encoding()

```php
public function encoding(array $supported = array()) : string
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Determines the best encoding type to use based on the $supported
types the application says it supports, and the types requested
by the client.
</td></tr>
</table>

<table>
<tr><td>
If no match is found, the first, highest-ranking client requested
type is returned.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$supported</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (158 - 163)</small></summary>

```php
public function encoding(array $supported = []): string
{
	array_push($supported, 'identity');

	return $this->getBestMatch($supported, $this->request->getHeaderLine('accept-encoding'));
}
```

</details>


<hr>

#### language()

```php
public function language(array $supported) : string
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Determines the best language to use based on the $supported
types the application says it supports, and the types requested
by the client.
</td></tr>
</table>

<table>
<tr><td>
If no match is found, the first, highest-ranking client requested
type is returned.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$supported</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 4 lines (179 - 182)</small></summary>

```php
public function language(array $supported): string
{
	return $this->getBestMatch($supported, $this->request->getHeaderLine('accept-language'), false, false, true);
}
```

</details>


<hr>

#### getBestMatch()

```php
protected function getBestMatch(array $supported, string $header = null, bool $enforceTypes = false, bool $strictMatch = false, bool $matchLocales = false) : string
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Does the grunt work of comparing any of the app-supported values
against a given Accept* header string.
</td></tr>
</table>

<table>
<tr><td>
Portions of this code base on Aura.Accept library.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$supported</code></td>
<td><em>array
</em></td>
<td>false</td>
<td>App-supported values</td>
</tr>

<tr>
<td>2.</td>
<td><code>$header</code></td>
<td><em>string
</em></td>
<td>false</td>
<td>header string</td>
</tr>

<tr>
<td>3.</td>
<td><code>$enforceTypes</code></td>
<td><em>bool
</em></td>
<td>false</td>
<td>If TRUE, will compare media types and sub-types.</td>
</tr>

<tr>
<td>4.</td>
<td><code>$strictMatch</code></td>
<td><em>bool
</em></td>
<td>false</td>
<td>If TRUE, will return empty string on no match.
If FALSE, will return the first supported element.</td>
</tr>

<tr>
<td>5.</td>
<td><code>$matchLocales</code></td>
<td><em>bool
</em></td>
<td>false</td>
<td>If TRUE, will match locale sub-types to a broad type (fr-FR = fr)</td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 41 lines (204 - 244)</small></summary>

```php
protected function getBestMatch(array $supported, string $header = null, bool $enforceTypes = false, bool $strictMatch = false, bool $matchLocales = false): string
{
	if (empty($supported))
	{
		throw HTTPException::forEmptySupportedNegotiations();
	}

	if (empty($header))
	{
		return $strictMatch ? '' : $supported[0];
	}

	$acceptable = $this->parseHeader($header);

	foreach ($acceptable as $accept)
	{
		// if acceptable quality is zero, skip it.
		if ($accept['q'] === 0.0)
		{
			continue;
		}

		// if acceptable value is "anything", return the first available
		if ($accept['value'] === '*' || $accept['value'] === '*/*')
		{
			return $supported[0];
		}

		// If an acceptable value is supported, return it
		foreach ($supported as $available)
		{
			if ($this->match($accept, $available, $enforceTypes, $matchLocales))
			{
				return $available;
			}
		}
	}

	// No matches? Return the first supported element.
	return $strictMatch ? '' : $supported[0];
}
```

</details>


<hr>

#### parseHeader()

```php
public function parseHeader(string $header) : array
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Parses an Accept* header into it's multiple values.
</td></tr>
</table>

<table>
<tr><td>
This is based on code from Aura.Accept library.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$header</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>array
</td>
</tr>
</table>





<details>
<summary><small>Source: 77 lines (257 - 333)</small></summary>

```php
public function parseHeader(string $header): array
{
	$results    = [];
	$acceptable = explode(',', $header);

	foreach ($acceptable as $value)
	{
		$pairs = explode(';', $value);

		$value = $pairs[0];

		unset($pairs[0]);

		$parameters = [];

		foreach ($pairs as $pair)
		{
			$param = [];
			preg_match(
					'/^(?P<name>.+?)=(?P<quoted>"|\')?(?P<value>.*?)(?:\k<quoted>)?$/', $pair, $param
			);
			$parameters[trim($param['name'])] = trim($param['value']);
		}

		$quality = 1.0;

		if (array_key_exists('q', $parameters))
		{
			$quality = $parameters['q'];
			unset($parameters['q']);
		}

		$results[] = [
			'value'  => trim($value),
			'q'      => (float) $quality,
			'params' => $parameters,
		];
	}

	// Sort to get the highest results first
	usort($results, function ($a, $b) {
		if ($a['q'] === $b['q'])
		{
			$a_ast = substr_count($a['value'], '*');
			$b_ast = substr_count($b['value'], '*');

			// '*/*' has lower precedence than 'text/*',
			// and 'text/*' has lower priority than 'text/plain'
			//
			// This seems backwards, but needs to be that way
			// due to the way PHP7 handles ordering or array
			// elements created by reference.
			if ($a_ast > $b_ast)
			{
				return 1;
			}

			// If the counts are the same, but one element
			// has more params than another, it has higher precedence.
			//
			// This seems backwards, but needs to be that way
			// due to the way PHP7 handles ordering or array
			// elements created by reference.
			if ($a_ast === $b_ast)
			{
				return count($b['params']) - count($a['params']);
			}

			return 0;
		}

		// Still here? Higher q values have precedence.
		return ($a['q'] > $b['q']) ? -1 : 1;
	});

	return $results;
}
```

</details>


<hr>

#### match()

```php
protected function match(array $acceptable, string $supported, bool $enforceTypes = false, $matchLocales = false) : bool
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Match-maker
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$acceptable</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$supported</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>3.</td>
<td><code>$enforceTypes</code></td>
<td><em>bool
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>4.</td>
<td><code>$matchLocales</code></td>
<td><em>bool
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>bool
</td>
</tr>
</table>





<details>
<summary><small>Source: 29 lines (347 - 375)</small></summary>

```php
protected function match(array $acceptable, string $supported, bool $enforceTypes = false, $matchLocales = false): bool
{
	$supported = $this->parseHeader($supported);
	if (is_array($supported) && count($supported) === 1)
	{
		$supported = $supported[0];
	}

	// Is it an exact match?
	if ($acceptable['value'] === $supported['value'])
	{
		return $this->matchParameters($acceptable, $supported);
	}

	// Do we need to compare types/sub-types? Only used
	// by negotiateMedia().
	if ($enforceTypes)
	{
		return $this->matchTypes($acceptable, $supported);
	}

	// Do we need to match locales against broader locales?
	if ($matchLocales)
	{
		return $this->matchLocales($acceptable, $supported);
	}

	return false;
}
```

</details>


<hr>

#### matchParameters()

```php
protected function matchParameters(array $acceptable, array $supported) : bool
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Checks two Accept values with matching 'values' to see if their
'params' are the same.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$acceptable</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$supported</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>bool
</td>
</tr>
</table>





<details>
<summary><small>Source: 18 lines (388 - 405)</small></summary>

```php
protected function matchParameters(array $acceptable, array $supported): bool
{
	if (count($acceptable['params']) !== count($supported['params']))
	{
		return false;
	}

	foreach ($supported['params'] as $label => $value)
	{
		if (! isset($acceptable['params'][$label]) ||
				$acceptable['params'][$label] !== $value)
		{
			return false;
		}
	}

	return true;
}
```

</details>


<hr>

#### matchTypes()

```php
public function matchTypes(array $acceptable, array $supported) : bool
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Compares the types/subtypes of an acceptable Media type and
the supported string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$acceptable</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$supported</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>bool
</td>
</tr>
</table>





<details>
<summary><small>Source: 22 lines (418 - 439)</small></summary>

```php
public function matchTypes(array $acceptable, array $supported): bool
{
	// PHPDocumentor v2 cannot parse yet the shorter list syntax,
	// causing no API generation for the file.
	list($aType, $aSubType) = explode('/', $acceptable['value']);
	list($sType, $sSubType) = explode('/', $supported['value']);

	// If the types don't match, we're done.
	if ($aType !== $sType)
	{
		return false;
	}

	// If there's an asterisk, we're cool
	if ($aSubType === '*')
	{
		return true;
	}

	// Otherwise, subtypes must match also.
	return $aSubType === $sSubType;
}
```

</details>


<hr>

#### matchLocales()

```php
public function matchLocales(array $acceptable, array $supported) : bool
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Will match locales against their broader pairs, so that fr-FR would
match a supported localed of fr
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$acceptable</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$supported</code></td>
<td><em>array
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>bool
</td>
</tr>
</table>





<details>
<summary><small>Source: 11 lines (452 - 462)</small></summary>

```php
public function matchLocales(array $acceptable, array $supported): bool
{
	$aBroad = mb_strpos($acceptable['value'], '-') > 0
		? mb_substr($acceptable['value'], 0, mb_strpos($acceptable['value'], '-'))
		: $acceptable['value'];
	$sBroad = mb_strpos($supported['value'], '-') > 0
		? mb_substr($supported['value'], 0, mb_strpos($supported['value'], '-'))
		: $supported['value'];

	return strtolower($aBroad) === strtolower($sBroad);
}
```

</details>





 


 
  




<hr>

<table>
<tr>
<td style="width:100%"><em>framework/system/HTTP/Negotiate.php</em></td>
<td><a href="../../../../../../api/index.md">index</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Message.md">prev</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/RedirectResponse.md">next</a></td>
<td><a href="#">top</a></td></tr>
</table>




<div style="text-align:right;">

<small>_Generated at **2020-08-14 07:35:12**_ *([EnixApp](https://github.com/enix-app) - [ApiDoc](https://github.com/enix-app/apidoc))*</small>
</div>