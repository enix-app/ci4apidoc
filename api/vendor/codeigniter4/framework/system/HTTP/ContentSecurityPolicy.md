


 



<table>
<tr>
<td style="width:100%"><em>framework/system/HTTP/ContentSecurityPolicy.php</em></td>
<td><a href="../../../../../../api/index.md">index</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/CURLRequest.md">prev</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/DownloadResponse.md">next</a></td>
</tr>
</table>







# CodeIgniter\HTTP 
<table style="text-align:left">
<tr><th>namespace</th><td>CodeIgniter\HTTP</td></tr>
</table>

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
CodeIgniter
</td></tr>
</table>

<table>
<tr><td>
An open source application development framework for PHP

This content is released under the MIT License (MIT)

Copyright (c) 2014-2019 British Columbia Institute of Technology
Copyright (c) 2019-2020 CodeIgniter Foundation

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
</td></tr>
</table>

</details>



<table style="text-align:left">
<tr style="vertical-align:top;">
<th>package</th>
<td>CodeIgniter
</td>
</tr>
<tr style="vertical-align:top;">
<th>author</th>
<td>CodeIgniter Dev Team
</td>
</tr>
<tr style="vertical-align:top;">
<th>copyright</th>
<td>2019-2020 CodeIgniter Foundation
</td>
</tr>
<tr style="vertical-align:top;">
<th>license</th>
<td><a href="https://opensource.org/licenses/MIT">https://opensource.org/licenses/MIT</a>	MIT License
</td>
</tr>
<tr style="vertical-align:top;">
<th>link</th>
<td><a href="https://codeigniter.com">https://codeigniter.com</a>

</td>
</tr>
<tr style="vertical-align:top;">
<th>filesource</th>
<td>framework/system/HTTP/ContentSecurityPolicy.php
</td>
</tr>
</table>

 

<details>
<summary style="margin-bottom:12px;"><strong>Members</strong></summary>
<table>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/CLIRequest.md">CodeIgniter\HTTP\CLIRequest</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/CURLRequest.md">CodeIgniter\HTTP\CURLRequest</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/ContentSecurityPolicy.md">CodeIgniter\HTTP\ContentSecurityPolicy</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/DownloadResponse.md">CodeIgniter\HTTP\DownloadResponse</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Exceptions/HTTPException.md">CodeIgniter\HTTP\Exceptions\HTTPException</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Files/FileCollection.md">CodeIgniter\HTTP\Files\FileCollection</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Files/UploadedFile.md">CodeIgniter\HTTP\Files\UploadedFile</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Files/UploadedFileInterface.md">CodeIgniter\HTTP\Files\UploadedFileInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Header.md">CodeIgniter\HTTP\Header</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/IncomingRequest.md">CodeIgniter\HTTP\IncomingRequest</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Message.md">CodeIgniter\HTTP\Message</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Negotiate.md">CodeIgniter\HTTP\Negotiate</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/RedirectResponse.md">CodeIgniter\HTTP\RedirectResponse</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Request.md">CodeIgniter\HTTP\Request</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/RequestInterface.md">CodeIgniter\HTTP\RequestInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Response.md">CodeIgniter\HTTP\Response</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/ResponseInterface.md">CodeIgniter\HTTP\ResponseInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/URI.md">CodeIgniter\HTTP\URI</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/UserAgent.md">CodeIgniter\HTTP\UserAgent</a></td></tr>
</table>
</details>



 

 
## CodeIgniter\HTTP\ContentSecurityPolicy

<table style="text-align:left">
<tr><th>Class</th><td>ContentSecurityPolicy</td></tr>
<tr><th>Fully Qualified Name</th><td>CodeIgniter\HTTP\ContentSecurityPolicy</td></tr>
</table>


<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Class ContentSecurityPolicy
</td></tr>
</table>

<table>
<tr><td>
Provides tools for working with the Content-Security-Policy header
to help defeat XSS attacks.
</td></tr>
</table>

</details>



<table style="text-align:left">
<tr style="vertical-align:top;">
<th>package</th>
<td>CodeIgniter\HTTP
</td>
</tr>
</table>



### Summary


<table style="text-align:left;">
<tr>
<th>Name</th>
<th>Element</th>
<th>Modifier</th>
<th>Description</th>
</tr>

<tr>
<th><a href="#baseURI"><strong>baseURI</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#childSrc"><strong>childSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#connectSrc"><strong>connectSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#defaultSrc"><strong>defaultSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#fontSrc"><strong>fontSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#formAction"><strong>formAction</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#frameAncestors"><strong>frameAncestors</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#imageSrc"><strong>imageSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#mediaSrc"><strong>mediaSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#objectSrc"><strong>objectSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#pluginTypes"><strong>pluginTypes</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#reportURI"><strong>reportURI</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#sandbox"><strong>sandbox</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#scriptSrc"><strong>scriptSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#styleSrc"><strong>styleSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#manifestSrc"><strong>manifestSrc</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#upgradeInsecureRequests"><strong>upgradeInsecureRequests</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#reportOnly"><strong>reportOnly</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#validSources"><strong>validSources</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#nonces"><strong>nonces</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Used for security enforcement</td>
</tr>
<tr>
<th><a href="#tempHeaders"><strong>tempHeaders</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>An array of header info since we have
to build ourself before passing to Response.</td>
</tr>
<tr>
<th><a href="#reportOnlyHeaders"><strong>reportOnlyHeaders</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>An array of header info to build
that should only be reported.</td>
</tr>

<tr>
<th><a href="#__construct"><strong>__construct</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>ContentSecurityPolicy constructor.</td>
</tr>
<tr>
<th><a href="#finalize"><strong>finalize</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Compiles and sets the appropriate headers in the request.</td>
</tr>
<tr>
<th><a href="#reportOnly"><strong>reportOnly</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>If TRUE, nothing will be restricted. Instead all violations will
be reported to the reportURI for monitoring. This is useful when
you are just starting to implement the policy, and will help
determine what errors need to be addressed before you turn on
all filtering.</td>
</tr>
<tr>
<th><a href="#addBaseURI"><strong>addBaseURI</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new base_uri value. Can be either a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addChildSrc"><strong>addChildSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for a form&#039;s action. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addConnectSrc"><strong>addConnectSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for a form&#039;s action. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#setDefaultSrc"><strong>setDefaultSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for a form&#039;s action. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addFontSrc"><strong>addFontSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for a form&#039;s action. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addFormAction"><strong>addFormAction</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for a form&#039;s action. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addFrameAncestor"><strong>addFrameAncestor</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new resource that should allow embedding the resource using
&lt;frame&gt;, &lt;iframe&gt;, &lt;object&gt;, &lt;embed&gt;, or &lt;applet&gt;</td>
</tr>
<tr>
<th><a href="#addImageSrc"><strong>addImageSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for valid image sources. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addMediaSrc"><strong>addMediaSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for valid video and audio. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addManifestSrc"><strong>addManifestSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for manifest sources. Can be either
a URI class or simple string.</td>
</tr>
<tr>
<th><a href="#addObjectSrc"><strong>addObjectSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for Flash and other plugin sources. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addPluginType"><strong>addPluginType</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Limits the types of plugins that can be used. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#setReportURI"><strong>setReportURI</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Specifies a URL where a browser will send reports when a content
security policy is violated. Can be either a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addSandbox"><strong>addSandbox</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>specifies an HTML sandbox policy that the user agent applies to
the protected resource.</td>
</tr>
<tr>
<th><a href="#addScriptSrc"><strong>addScriptSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for javascript file sources. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#addStyleSrc"><strong>addStyleSrc</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Adds a new valid endpoint for CSS file sources. Can be either
a URI class or a simple string.</td>
</tr>
<tr>
<th><a href="#upgradeInsecureRequests"><strong>upgradeInsecureRequests</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Sets whether the user agents should rewrite URL schemes, changing
HTTP to HTTPS.</td>
</tr>
<tr>
<th><a href="#addOption"><strong>addOption</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>DRY method to add an string or array to a class property.</td>
</tr>
<tr>
<th><a href="#generateNonces"><strong>generateNonces</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Scans the body of the request message and replaces any nonce
placeholders with actual nonces, that we&#039;ll then add to our
headers.</td>
</tr>
<tr>
<th><a href="#buildHeaders"><strong>buildHeaders</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Based on the current state of the elements, will add the appropriate
Content-Security-Policy and Content-Security-Policy-Report-Only headers
with their values to the response object.</td>
</tr>
<tr>
<th><a href="#addToHeader"><strong>addToHeader</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Adds a directive and it&#039;s options to the appropriate header. The $values
array might have options that are geared toward either the regular or the
reportOnly header, since it&#039;s viable to have both simultaneously.</td>
</tr>

</table>





### Properties


<hr>

#### $baseURI

```php
protected $baseURI = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $childSrc

```php
protected $childSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $connectSrc

```php
protected $connectSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array
</td>
</tr>
</table>


<hr>

#### $defaultSrc

```php
protected $defaultSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $fontSrc

```php
protected $fontSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $formAction

```php
protected $formAction = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $frameAncestors

```php
protected $frameAncestors = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $imageSrc

```php
protected $imageSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $mediaSrc

```php
protected $mediaSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $objectSrc

```php
protected $objectSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $pluginTypes

```php
protected $pluginTypes = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $reportURI

```php
protected $reportURI;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>string
</td>
</tr>
</table>


<hr>

#### $sandbox

```php
protected $sandbox = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $scriptSrc

```php
protected $scriptSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $styleSrc

```php
protected $styleSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $manifestSrc

```php
protected $manifestSrc = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array<br>string
</td>
</tr>
</table>


<hr>

#### $upgradeInsecureRequests

```php
protected $upgradeInsecureRequests = false;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>bool
</td>
</tr>
</table>


<hr>

#### $reportOnly

```php
protected $reportOnly = false;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>bool
</td>
</tr>
</table>


<hr>

#### $validSources

```php
protected $validSources = [
	'self',
	'none',
	'unsafe-inline',
	'unsafe-eval',
];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array
</td>
</tr>
</table>


<hr>

#### $nonces

```php
protected $nonces = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Used for security enforcement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array
</td>
</tr>
</table>


<hr>

#### $tempHeaders

```php
protected $tempHeaders = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
An array of header info since we have
to build ourself before passing to Response.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array
</td>
</tr>
</table>


<hr>

#### $reportOnlyHeaders

```php
protected $reportOnlyHeaders = [];
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
An array of header info to build
that should only be reported.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>array
</td>
</tr>
</table>







### Methods


<hr>

#### __construct()

```php
public function __construct(\Config\ContentSecurityPolicy $config)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
ContentSecurityPolicy constructor.
</td></tr>
</table>

<table>
<tr><td>
Stores our default values from the Config file.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$config</code></td>
<td><em>\Config\ContentSecurityPolicy
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 10 lines (227 - 236)</small></summary>

```php
public function __construct(\Config\ContentSecurityPolicy $config)
{
	foreach ($config as $setting => $value)
	{
		if (isset($this->{$setting}))
		{
			$this->{$setting} = $value;
		}
	}
}
```

</details>


<hr>

#### finalize()

```php
public function finalize(ResponseInterface &$response)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Compiles and sets the appropriate headers in the request.
</td></tr>
</table>

<table>
<tr><td>
Should be called just prior to sending the response to the user agent.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$response</code></td>
<td><em>\ResponseInterface
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 6 lines (247 - 252)</small></summary>

```php
public function finalize(ResponseInterface &$response)
{
	$this->generateNonces($response);

	$this->buildHeaders($response);
}
```

</details>


<hr>

#### reportOnly()

```php
public function reportOnly(bool $value = true)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
If TRUE, nothing will be restricted. Instead all violations will
be reported to the reportURI for monitoring. This is useful when
you are just starting to implement the policy, and will help
determine what errors need to be addressed before you turn on
all filtering.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$value</code></td>
<td><em>bool<br>true
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (267 - 272)</small></summary>

```php
public function reportOnly(bool $value = true)
{
	$this->reportOnly = $value;

	return $this;
}
```

</details>


<hr>

#### addBaseURI()

```php
public function addBaseURI($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new base_uri value. Can be either a URI class or a simple string.
</td></tr>
</table>

<table>
<tr><td>
base_uri restricts the URLs that can appear in a page’s <base> element.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (288 - 293)</small></summary>

```php
public function addBaseURI($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'baseURI', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addChildSrc()

```php
public function addChildSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for a form's action. Can be either
a URI class or a simple string.
</td></tr>
</table>

<table>
<tr><td>
child-src lists the URLs for workers and embedded frame contents.
For example: child-src <a href="https://youtube.com">https://youtube.com</a> would enable embedding
videos from YouTube but not from other origins.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (312 - 317)</small></summary>

```php
public function addChildSrc($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'childSrc', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addConnectSrc()

```php
public function addConnectSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for a form's action. Can be either
a URI class or a simple string.
</td></tr>
</table>

<table>
<tr><td>
connect-src limits the origins to which you can connect
(via XHR, WebSockets, and EventSource).
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (335 - 340)</small></summary>

```php
public function addConnectSrc($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'connectSrc', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### setDefaultSrc()

```php
public function setDefaultSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for a form's action. Can be either
a URI class or a simple string.
</td></tr>
</table>

<table>
<tr><td>
default_src is the URI that is used for many of the settings when
no other source has been set.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (358 - 363)</small></summary>

```php
public function setDefaultSrc($uri, bool $explicitReporting = null)
{
	$this->defaultSrc = [(string) $uri => $explicitReporting ?? $this->reportOnly];

	return $this;
}
```

</details>


<hr>

#### addFontSrc()

```php
public function addFontSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for a form's action. Can be either
a URI class or a simple string.
</td></tr>
</table>

<table>
<tr><td>
font-src specifies the origins that can serve web fonts.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (380 - 385)</small></summary>

```php
public function addFontSrc($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'fontSrc', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addFormAction()

```php
public function addFormAction($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for a form's action. Can be either
a URI class or a simple string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (400 - 405)</small></summary>

```php
public function addFormAction($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'formAction', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addFrameAncestor()

```php
public function addFrameAncestor($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new resource that should allow embedding the resource using
<frame>, <iframe>, <object>, <embed>, or <applet>
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (420 - 425)</small></summary>

```php
public function addFrameAncestor($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'frameAncestors', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addImageSrc()

```php
public function addImageSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for valid image sources. Can be either
a URI class or a simple string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (440 - 445)</small></summary>

```php
public function addImageSrc($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'imageSrc', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addMediaSrc()

```php
public function addMediaSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for valid video and audio. Can be either
a URI class or a simple string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (460 - 465)</small></summary>

```php
public function addMediaSrc($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'mediaSrc', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addManifestSrc()

```php
public function addManifestSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for manifest sources. Can be either
a URI class or simple string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (480 - 485)</small></summary>

```php
public function addManifestSrc($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'manifestSrc', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addObjectSrc()

```php
public function addObjectSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for Flash and other plugin sources. Can be either
a URI class or a simple string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (500 - 505)</small></summary>

```php
public function addObjectSrc($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'objectSrc', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addPluginType()

```php
public function addPluginType($mime, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Limits the types of plugins that can be used. Can be either
a URI class or a simple string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$mime</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td>One or more plugin mime types, separate by spaces</td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (520 - 525)</small></summary>

```php
public function addPluginType($mime, bool $explicitReporting = null)
{
	$this->addOption($mime, 'pluginTypes', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### setReportURI()

```php
public function setReportURI(string $uri)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Specifies a URL where a browser will send reports when a content
security policy is violated. Can be either a URI class or a simple string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (539 - 544)</small></summary>

```php
public function setReportURI(string $uri)
{
	$this->reportURI = $uri;

	return $this;
}
```

</details>


<hr>

#### addSandbox()

```php
public function addSandbox($flags, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
specifies an HTML sandbox policy that the user agent applies to
the protected resource.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$flags</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td>An array of sandbox flags that can be added to the directive.</td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 5 lines (559 - 563)</small></summary>

```php
public function addSandbox($flags, bool $explicitReporting = null)
{
	$this->addOption($flags, 'sandbox', $explicitReporting ?? $this->reportOnly);
	return $this;
}
```

</details>


<hr>

#### addScriptSrc()

```php
public function addScriptSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for javascript file sources. Can be either
a URI class or a simple string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (578 - 583)</small></summary>

```php
public function addScriptSrc($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'scriptSrc', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### addStyleSrc()

```php
public function addStyleSrc($uri, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a new valid endpoint for CSS file sources. Can be either
a URI class or a simple string.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$uri</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (598 - 603)</small></summary>

```php
public function addStyleSrc($uri, bool $explicitReporting = null)
{
	$this->addOption($uri, 'styleSrc', $explicitReporting ?? $this->reportOnly);

	return $this;
}
```

</details>


<hr>

#### upgradeInsecureRequests()

```php
public function upgradeInsecureRequests(bool $value = true)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Sets whether the user agents should rewrite URL schemes, changing
HTTP to HTTPS.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$value</code></td>
<td><em>bool
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>$this
</td>
</tr>
</table>





<details>
<summary><small>Source: 6 lines (615 - 620)</small></summary>

```php
public function upgradeInsecureRequests(bool $value = true)
{
	$this->upgradeInsecureRequests = $value;

	return $this;
}
```

</details>


<hr>

#### addOption()

```php
protected function addOption($options, string $target, bool $explicitReporting = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
DRY method to add an string or array to a class property.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$options</code></td>
<td><em>string<br>array
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$target</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>3.</td>
<td><code>$explicitReporting</code></td>
<td><em>bool<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 20 lines (633 - 652)</small></summary>

```php
protected function addOption($options, string $target, bool $explicitReporting = null)
{
	// Ensure we have an array to work with...
	if (is_string($this->{$target}))
	{
		$this->{$target} = [$this->{$target}];
	}

	if (is_array($options))
	{
		foreach ($options as $opt)
		{
			$this->{$target}[$opt] = $explicitReporting ?? $this->reportOnly;
		}
	}
	else
	{
		$this->{$target}[$options] = $explicitReporting ?? $this->reportOnly;
	}
}
```

</details>


<hr>

#### generateNonces()

```php
protected function generateNonces(ResponseInterface &$response)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Scans the body of the request message and replaces any nonce
placeholders with actual nonces, that we'll then add to our
headers.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$response</code></td>
<td><em>\ResponseInterface<br>\CodeIgniter\HTTP\Response
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 42 lines (663 - 704)</small></summary>

```php
protected function generateNonces(ResponseInterface &$response)
{
	$body = $response->getBody();

	if (empty($body))
	{
		return;
	}

	if (! is_array($this->styleSrc))
	{
		$this->styleSrc = [$this->styleSrc];
	}
	if (! is_array($this->scriptSrc))
	{
		$this->scriptSrc = [$this->scriptSrc];
	}

	// Replace style placeholders with nonces
	$body = preg_replace_callback(
			'/{csp-style-nonce}/', function ($matches) {
				$nonce = bin2hex(random_bytes(12));

				$this->styleSrc[] = 'nonce-' . $nonce;

				return "nonce=\"{$nonce}\"";
			}, $body
	);

	// Replace script placeholders with nonces
	$body = preg_replace_callback(
			'/{csp-script-nonce}/', function ($matches) {
				$nonce = bin2hex(random_bytes(12));

				$this->scriptSrc[] = 'nonce-' . $nonce;

				return "nonce=\"{$nonce}\"";
			}, $body
	);

	$response->setBody($body);
}
```

</details>


<hr>

#### buildHeaders()

```php
protected function buildHeaders(ResponseInterface &$response)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Based on the current state of the elements, will add the appropriate
Content-Security-Policy and Content-Security-Policy-Report-Only headers
with their values to the response object.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$response</code></td>
<td><em>\ResponseInterface<br>\CodeIgniter\HTTP\Response
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 76 lines (715 - 790)</small></summary>

```php
protected function buildHeaders(ResponseInterface &$response)
{
	// Ensure both headers are available and arrays...
	$response->setHeader('Content-Security-Policy', []);
	$response->setHeader('Content-Security-Policy-Report-Only', []);

	$directives = [
		'base-uri'        => 'baseURI',
		'child-src'       => 'childSrc',
		'connect-src'     => 'connectSrc',
		'default-src'     => 'defaultSrc',
		'font-src'        => 'fontSrc',
		'form-action'     => 'formAction',
		'frame-ancestors' => 'frameAncestors',
		'img-src'         => 'imageSrc',
		'media-src'       => 'mediaSrc',
		'object-src'      => 'objectSrc',
		'plugin-types'    => 'pluginTypes',
		'script-src'      => 'scriptSrc',
		'style-src'       => 'styleSrc',
		'manifest-src'    => 'manifestSrc',
		'sandbox'         => 'sandbox',
		'report-uri'      => 'reportURI',
	];

	// inject default base & default URIs if needed
	if (empty($this->baseURI))
	{
		$this->baseURI = 'self';
	}
	if (empty($this->defaultSrc))
	{
		$this->defaultSrc = 'self';
	}

	foreach ($directives as $name => $property)
	{
		// base_uri
		if (! empty($this->{$property}))
		{
			$this->addToHeader($name, $this->{$property});
		}
	}

	// Compile our own header strings here since if we just
	// append it to the response, it will be joined with
	// commas, not semi-colons as we need.
	if (! empty($this->tempHeaders))
	{
		$header = '';
		foreach ($this->tempHeaders as $name => $value)
		{
			$header .= " {$name} {$value};";
		}
		// add token only if needed
		if ($this->upgradeInsecureRequests)
		{
			$header .= ' upgrade-insecure-requests;';
		}

		$response->appendHeader('Content-Security-Policy', $header);
	}

	if (! empty($this->reportOnlyHeaders))
	{
		$header = '';
		foreach ($this->reportOnlyHeaders as $name => $value)
		{
			$header .= " {$name} {$value};";
		}
		$response->appendHeader('Content-Security-Policy-Report-Only', $header);
	}

	$this->tempHeaders       = [];
	$this->reportOnlyHeaders = [];
}
```

</details>


<hr>

#### addToHeader()

```php
protected function addToHeader(string $name, $values = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Adds a directive and it's options to the appropriate header. The $values
array might have options that are geared toward either the regular or the
reportOnly header, since it's viable to have both simultaneously.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$name</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$values</code></td>
<td><em>array<br>string<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 45 lines (802 - 846)</small></summary>

```php
protected function addToHeader(string $name, $values = null)
{
	if (is_string($values))
	{
		$values = [$values => 0];
	}

	$sources       = [];
	$reportSources = [];

	foreach ($values as $value => $reportOnly)
	{
		if (is_numeric($value) && is_string($reportOnly) && ! empty($reportOnly))
		{
			$value      = $reportOnly;
			$reportOnly = 0;
		}

		if ($reportOnly === true)
		{
			$reportSources[] = in_array($value, $this->validSources) ? "'{$value}'" : $value;
		}
		else
		{
			if (strpos($value, 'nonce-') === 0)
			{
				$sources[] = "'{$value}'";
			}
			else
			{
				$sources[] = in_array($value, $this->validSources) ? "'{$value}'" : $value;
			}
		}
	}

	if (! empty($sources))
	{
		$this->tempHeaders[$name] = implode(' ', $sources);
	}

	if (! empty($reportSources))
	{
		$this->reportOnlyHeaders[$name] = implode(' ', $reportSources);
	}
}
```

</details>





 


 
  




<hr>

<table>
<tr>
<td style="width:100%"><em>framework/system/HTTP/ContentSecurityPolicy.php</em></td>
<td><a href="../../../../../../api/index.md">index</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/CURLRequest.md">prev</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/DownloadResponse.md">next</a></td>
<td><a href="#">top</a></td></tr>
</table>




<div style="text-align:right;">

<small>_Generated at **2020-08-14 07:35:12**_ *([EnixApp](https://github.com/enix-app) - [ApiDoc](https://github.com/enix-app/apidoc))*</small>
</div>