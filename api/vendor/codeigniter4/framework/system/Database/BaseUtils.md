


 



<table>
<tr>
<td style="width:100%"><em>framework/system/Database/BaseUtils.php</em></td>
<td><a href="../../../../../../api/index.md">index</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/BaseResult.md">prev</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Config.md">next</a></td>
</tr>
</table>







# CodeIgniter\Database 
<table style="text-align:left">
<tr><th>namespace</th><td>CodeIgniter\Database</td></tr>
</table>

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
CodeIgniter
</td></tr>
</table>

<table>
<tr><td>
An open source application development framework for PHP

This content is released under the MIT License (MIT)

Copyright (c) 2014-2019 British Columbia Institute of Technology
Copyright (c) 2019-2020 CodeIgniter Foundation

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
</td></tr>
</table>

</details>



<table style="text-align:left">
<tr style="vertical-align:top;">
<th>package</th>
<td>CodeIgniter
</td>
</tr>
<tr style="vertical-align:top;">
<th>author</th>
<td>CodeIgniter Dev Team
</td>
</tr>
<tr style="vertical-align:top;">
<th>copyright</th>
<td>2019-2020 CodeIgniter Foundation
</td>
</tr>
<tr style="vertical-align:top;">
<th>license</th>
<td><a href="https://opensource.org/licenses/MIT">https://opensource.org/licenses/MIT</a>	MIT License
</td>
</tr>
<tr style="vertical-align:top;">
<th>link</th>
<td><a href="https://codeigniter.com">https://codeigniter.com</a>

</td>
</tr>
<tr style="vertical-align:top;">
<th>filesource</th>
<td>framework/system/Database/BaseUtils.php
</td>
</tr>
</table>

 

<details>
<summary style="margin-bottom:12px;"><strong>Members</strong></summary>
<table>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/BaseBuilder.md">CodeIgniter\Database\BaseBuilder</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/BaseConnection.md">CodeIgniter\Database\BaseConnection</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/BasePreparedQuery.md">CodeIgniter\Database\BasePreparedQuery</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/BaseResult.md">CodeIgniter\Database\BaseResult</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/BaseUtils.md">CodeIgniter\Database\BaseUtils</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Config.md">CodeIgniter\Database\Config</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/ConnectionInterface.md">CodeIgniter\Database\ConnectionInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Database.md">CodeIgniter\Database\Database</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Exceptions/DataException.md">CodeIgniter\Database\Exceptions\DataException</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Exceptions/DatabaseException.md">CodeIgniter\Database\Exceptions\DatabaseException</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Exceptions/ExceptionInterface.md">CodeIgniter\Database\Exceptions\ExceptionInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Forge.md">CodeIgniter\Database\Forge</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Migration.md">CodeIgniter\Database\Migration</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/MigrationRunner.md">CodeIgniter\Database\MigrationRunner</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/ModelFactory.md">CodeIgniter\Database\ModelFactory</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/MySQLi/Builder.md">CodeIgniter\Database\MySQLi\Builder</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.md">CodeIgniter\Database\MySQLi\Connection</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/MySQLi/Forge.md">CodeIgniter\Database\MySQLi\Forge</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/MySQLi/PreparedQuery.md">CodeIgniter\Database\MySQLi\PreparedQuery</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/MySQLi/Result.md">CodeIgniter\Database\MySQLi\Result</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/MySQLi/Utils.md">CodeIgniter\Database\MySQLi\Utils</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Postgre/Builder.md">CodeIgniter\Database\Postgre\Builder</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Postgre/Connection.md">CodeIgniter\Database\Postgre\Connection</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Postgre/Forge.md">CodeIgniter\Database\Postgre\Forge</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Postgre/PreparedQuery.md">CodeIgniter\Database\Postgre\PreparedQuery</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Postgre/Result.md">CodeIgniter\Database\Postgre\Result</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Postgre/Utils.md">CodeIgniter\Database\Postgre\Utils</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/PreparedQueryInterface.md">CodeIgniter\Database\PreparedQueryInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Query.md">CodeIgniter\Database\Query</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/QueryInterface.md">CodeIgniter\Database\QueryInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/ResultInterface.md">CodeIgniter\Database\ResultInterface</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/SQLite3/Builder.md">CodeIgniter\Database\SQLite3\Builder</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/SQLite3/Connection.md">CodeIgniter\Database\SQLite3\Connection</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/SQLite3/Forge.md">CodeIgniter\Database\SQLite3\Forge</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/SQLite3/PreparedQuery.md">CodeIgniter\Database\SQLite3\PreparedQuery</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/SQLite3/Result.md">CodeIgniter\Database\SQLite3\Result</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/SQLite3/Table.md">CodeIgniter\Database\SQLite3\Table</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/SQLite3/Utils.md">CodeIgniter\Database\SQLite3\Utils</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Seeder.md">CodeIgniter\Database\Seeder</a></td></tr>
</table>
</details>



 
 ## Uses

<table style="text-align:left;">
<tr>
<td>
<a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Exceptions/DatabaseException.md"><strong>CodeIgniter\Database\Exceptions\DatabaseException</strong></a>
</td>
<td>DatabaseException</td>
</tr>
</table>



 
## CodeIgniter\Database\BaseUtils

<table style="text-align:left">
<tr><th>Abstract</th><td>BaseUtils</td></tr>
<tr><th>Fully Qualified Name</th><td>CodeIgniter\Database\BaseUtils</td></tr>
</table>


<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Class BaseUtils
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>



### Summary


<table style="text-align:left;">
<tr>
<th>Name</th>
<th>Element</th>
<th>Modifier</th>
<th>Description</th>
</tr>

<tr>
<th><a href="#db"><strong>db</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Database object</td>
</tr>
<tr>
<th><a href="#listDatabases"><strong>listDatabases</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>List databases statement</td>
</tr>
<tr>
<th><a href="#optimizeTable"><strong>optimizeTable</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>OPTIMIZE TABLE statement</td>
</tr>
<tr>
<th><a href="#repairTable"><strong>repairTable</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>REPAIR TABLE statement</td>
</tr>

<tr>
<th><a href="#__construct"><strong>__construct</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Class constructor</td>
</tr>
<tr>
<th><a href="#listDatabases"><strong>listDatabases</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>List databases</td>
</tr>
<tr>
<th><a href="#databaseExists"><strong>databaseExists</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Determine if a particular database exists</td>
</tr>
<tr>
<th><a href="#optimizeTable"><strong>optimizeTable</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Optimize Table</td>
</tr>
<tr>
<th><a href="#optimizeDatabase"><strong>optimizeDatabase</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Optimize Database</td>
</tr>
<tr>
<th><a href="#repairTable"><strong>repairTable</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Repair Table</td>
</tr>
<tr>
<th><a href="#getCSVFromResult"><strong>getCSVFromResult</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Generate CSV from a query result object</td>
</tr>
<tr>
<th><a href="#getXMLFromResult"><strong>getXMLFromResult</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Generate XML data from a query result object</td>
</tr>
<tr>
<th><a href="#backup"><strong>backup</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Database Backup</td>
</tr>
<tr>
<th><a href="#_backup"><strong>_backup</strong>()</a></th>
<td>method</td>
<td>
public<br>abstract

</td>
<td>Platform dependent version of the backup function.</td>
</tr>

</table>





### Properties


<hr>

#### $db

```php
protected $db;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Database object
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>object
</td>
</tr>
</table>


<hr>

#### $listDatabases

```php
protected $listDatabases = false;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
List databases statement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>string
</td>
</tr>
</table>


<hr>

#### $optimizeTable

```php
protected $optimizeTable = false;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
OPTIMIZE TABLE statement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>string
</td>
</tr>
</table>


<hr>

#### $repairTable

```php
protected $repairTable = false;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
REPAIR TABLE statement
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>string
</td>
</tr>
</table>







### Methods


<hr>

#### __construct()

```php
public function __construct(ConnectionInterface &$db)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Class constructor
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$db</code></td>
<td><em>\ConnectionInterface<br>object
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 4 lines (87 - 90)</small></summary>

```php
public function __construct(ConnectionInterface &$db)
{
	$this->db = & $db;
}
```

</details>


<hr>

#### listDatabases()

```php
public function listDatabases()
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
List databases
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>





<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>array<br>bool
</td>
</tr>
</table>


<table>
<tr>
<th style="vertical-align:top;">throw</th>
<td>\CodeIgniter\Database\Exceptions\DatabaseException
</td>
</tr>
</table>



<details>
<summary><small>Source: 31 lines (100 - 130)</small></summary>

```php
public function listDatabases()
{
	// Is there a cached result?
	if (isset($this->db->dataCache['db_names']))
	{
		return $this->db->dataCache['db_names'];
	}
	elseif ($this->listDatabases === false)
	{
		if ($this->db->DBDebug)
		{
			throw new DatabaseException('Unsupported feature of the database platform you are using.');
		}
		return false;
	}

	$this->db->dataCache['db_names'] = [];

	$query = $this->db->query($this->listDatabases);
	if ($query === false)
	{
		return $this->db->dataCache['db_names'];
	}

	for ($i = 0, $query = $query->getResultArray(), $c = count($query); $i < $c; $i ++)
	{
		$this->db->dataCache['db_names'][] = current($query[$i]);
	}

	return $this->db->dataCache['db_names'];
}
```

</details>


<hr>

#### databaseExists()

```php
public function databaseExists(string $database_name) : bool
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Determine if a particular database exists
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$database_name</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>bool
</td>
</tr>
</table>





<details>
<summary><small>Source: 4 lines (140 - 143)</small></summary>

```php
public function databaseExists(string $database_name): bool
{
	return in_array($database_name, $this->listDatabases());
}
```

</details>


<hr>

#### optimizeTable()

```php
public function optimizeTable(string $table_name)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Optimize Table
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$table_name</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>mixed
</td>
</tr>
</table>


<table>
<tr>
<th style="vertical-align:top;">throw</th>
<td>\CodeIgniter\Database\Exceptions\DatabaseException
</td>
</tr>
</table>



<details>
<summary><small>Source: 20 lines (154 - 173)</small></summary>

```php
public function optimizeTable(string $table_name)
{
	if ($this->optimizeTable === false)
	{
		if ($this->db->DBDebug)
		{
			throw new DatabaseException('Unsupported feature of the database platform you are using.');
		}
		return false;
	}

	$query = $this->db->query(sprintf($this->optimizeTable, $this->db->escapeIdentifiers($table_name)));
	if ($query !== false)
	{
		$query = $query->getResultArray();
		return current($query);
	}

	return false;
}
```

</details>


<hr>

#### optimizeDatabase()

```php
public function optimizeDatabase()
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Optimize Database
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>





<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>mixed
</td>
</tr>
</table>


<table>
<tr>
<th style="vertical-align:top;">throw</th>
<td>\CodeIgniter\Database\Exceptions\DatabaseException
</td>
</tr>
</table>



<details>
<summary><small>Source: 42 lines (183 - 224)</small></summary>

```php
public function optimizeDatabase()
{
	if ($this->optimizeTable === false)
	{
		if ($this->db->DBDebug)
		{
			throw new DatabaseException('Unsupported feature of the database platform you are using.');
		}
		return false;
	}

	$result = [];
	foreach ($this->db->listTables() as $table_name)
	{
		$res = $this->db->query(sprintf($this->optimizeTable, $this->db->escapeIdentifiers($table_name)));
		if (is_bool($res))
		{
			return $res;
		}

		// Build the result array...

		$res = $res->getResultArray();

		// Postgre & SQLite3 returns empty array
		if (empty($res))
		{
			$key = $table_name;
		}
		else
		{
			$res  = current($res);
			$key  = str_replace($this->db->database . '.', '', current($res));
			$keys = array_keys($res);
			unset($res[$keys[0]]);
		}

		$result[$key] = $res;
	}

	return $result;
}
```

</details>


<hr>

#### repairTable()

```php
public function repairTable(string $table_name)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Repair Table
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$table_name</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>mixed
</td>
</tr>
</table>


<table>
<tr>
<th style="vertical-align:top;">throw</th>
<td>\CodeIgniter\Database\Exceptions\DatabaseException
</td>
</tr>
</table>



<details>
<summary><small>Source: 20 lines (235 - 254)</small></summary>

```php
public function repairTable(string $table_name)
{
	if ($this->repairTable === false)
	{
		if ($this->db->DBDebug)
		{
			throw new DatabaseException('Unsupported feature of the database platform you are using.');
		}
		return false;
	}

	$query = $this->db->query(sprintf($this->repairTable, $this->db->escapeIdentifiers($table_name)));
	if (is_bool($query))
	{
		return $query;
	}

	$query = $query->getResultArray();
	return current($query);
}
```

</details>


<hr>

#### getCSVFromResult()

```php
public function getCSVFromResult(ResultInterface $query, string $delim = ',', string $newline = "\n", string $enclosure = '"')
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Generate CSV from a query result object
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$query</code></td>
<td><em>\ResultInterface
</em></td>
<td>false</td>
<td>Query result object</td>
</tr>

<tr>
<td>2.</td>
<td><code>$delim</code></td>
<td><em>string
</em></td>
<td>false</td>
<td>Delimiter (default: ,)</td>
</tr>

<tr>
<td>3.</td>
<td><code>$newline</code></td>
<td><em>string
</em></td>
<td>false</td>
<td>Newline character (default: \n)</td>
</tr>

<tr>
<td>4.</td>
<td><code>$enclosure</code></td>
<td><em>string
</em></td>
<td>false</td>
<td>Enclosure (default: ")</td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 24 lines (268 - 291)</small></summary>

```php
public function getCSVFromResult(ResultInterface $query, string $delim = ',', string $newline = "\n", string $enclosure = '"')
{
	$out = '';
	// First generate the headings from the table column names
	foreach ($query->getFieldNames() as $name)
	{
		$out .= $enclosure . str_replace($enclosure, $enclosure . $enclosure, $name) . $enclosure . $delim;
	}

	$out = substr($out, 0, -strlen($delim)) . $newline;

	// Next blast through the result array and build out the rows
	while ($row = $query->getUnbufferedRow('array'))
	{
		$line = [];
		foreach ($row as $item)
		{
			$line[] = $enclosure . str_replace($enclosure, $enclosure . $enclosure, $item) . $enclosure;
		}
		$out .= implode($delim, $line) . $newline;
	}

	return $out;
}
```

</details>


<hr>

#### getXMLFromResult()

```php
public function getXMLFromResult(ResultInterface $query, array $params = array()) : string
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Generate XML data from a query result object
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$query</code></td>
<td><em>\ResultInterface
</em></td>
<td>false</td>
<td>Query result object</td>
</tr>

<tr>
<td>2.</td>
<td><code>$params</code></td>
<td><em>array
</em></td>
<td>false</td>
<td>Any preferences</td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 31 lines (303 - 333)</small></summary>

```php
public function getXMLFromResult(ResultInterface $query, array $params = []): string
{
	// Set our default values
	foreach (['root' => 'root', 'element' => 'element', 'newline' => "\n", 'tab' => "\t"] as $key => $val)
	{
		if (! isset($params[$key]))
		{
			$params[$key] = $val;
		}
	}

	// Create variables for convenience
	extract($params);

	// Load the xml helper
	helper('xml');
	// Generate the result
	$xml = '<' . $root . '>' . $newline;
	while ($row = $query->getUnbufferedRow())
	{
		$xml .= $tab . '<' . $element . '>' . $newline;
		foreach ($row as $key => $val)
		{
			$val  = (! empty($val)) ? xml_convert($val) : '';
			$xml .= $tab . $tab . '<' . $key . '>' . $val . '</' . $key . '>' . $newline;
		}
		$xml .= $tab . '</' . $element . '>' . $newline;
	}

	return $xml . '</' . $root . '>' . $newline;
}
```

</details>


<hr>

#### backup()

```php
public function backup($params = array())
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Database Backup
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$params</code></td>
<td><em>array<br>string
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>mixed
</td>
</tr>
</table>


<table>
<tr>
<th style="vertical-align:top;">throw</th>
<td>\CodeIgniter\Database\Exceptions\DatabaseException
</td>
</tr>
</table>



<details>
<summary><small>Source: 66 lines (344 - 409)</small></summary>

```php
public function backup($params = [])
{
	// If the parameters have not been submitted as an
	// array then we know that it is simply the table
	// name, which is a valid short cut.
	if (is_string($params))
	{
		$params = ['tables' => $params];
	}

	// Set up our default preferences
	$prefs = [
		'tables'             => [],
		'ignore'             => [],
		'filename'           => '',
		'format'             => 'gzip', // gzip, txt
		'add_drop'           => true,
		'add_insert'         => true,
		'newline'            => "\n",
		'foreign_key_checks' => true,
	];

	// Did the user submit any preferences? If so set them....
	if (! empty($params))
	{
		foreach ($prefs as $key => $val)
		{
			if (isset($params[$key]))
			{
				$prefs[$key] = $params[$key];
			}
		}
	}

	// Are we backing up a complete database or individual tables?
	// If no table names were submitted we'll fetch the entire table list
	if (empty($prefs['tables']))
	{
		$prefs['tables'] = $this->db->listTables();
	}

	// Validate the format
	if (! in_array($prefs['format'], ['gzip', 'txt'], true))
	{
		$prefs['format'] = 'txt';
	}

	// Is the encoder supported? If not, we'll either issue an
	// error or use plain text depending on the debug settings
	if ($prefs['format'] === 'gzip' && ! function_exists('gzencode'))
	{
		if ($this->db->DBDebug)
		{
			throw new DatabaseException('The file compression format you chose is not supported by your server.');
		}

		$prefs['format'] = 'txt';
	}

	if ($prefs['format'] === 'txt') // Was a text file requested?
	{
		return $this->_backup($prefs);
	}

	return gzencode($this->_backup($prefs));
}
```

</details>


<hr>

#### _backup()

```php
public abstract function _backup(array $prefs = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Platform dependent version of the backup function.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$prefs</code></td>
<td><em>array<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>mixed
</td>
</tr>
</table>





<details>
<summary><small>Source: line 420</small></summary>

```php
abstract public function _backup(array $prefs = null);
```

</details>





 


 
  




<hr>

<table>
<tr>
<td style="width:100%"><em>framework/system/Database/BaseUtils.php</em></td>
<td><a href="../../../../../../api/index.md">index</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/BaseResult.md">prev</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Config.md">next</a></td>
<td><a href="#">top</a></td></tr>
</table>




<div style="text-align:right;">

<small>_Generated at **2020-08-14 07:35:09**_ *([EnixApp](https://github.com/enix-app) - [ApiDoc](https://github.com/enix-app/apidoc))*</small>
</div>