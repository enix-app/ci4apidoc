


 



<table>
<tr>
<td style="width:100%"><em>framework/system/Debug/Exceptions.php</em></td>
<td><a href="../../../../../../api/index.md">index</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Seeder.md">prev</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Iterator.md">next</a></td>
</tr>
</table>







# CodeIgniter\Debug 
<table style="text-align:left">
<tr><th>namespace</th><td>CodeIgniter\Debug</td></tr>
</table>

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
CodeIgniter
</td></tr>
</table>

<table>
<tr><td>
An open source application development framework for PHP

This content is released under the MIT License (MIT)

Copyright (c) 2014-2019 British Columbia Institute of Technology
Copyright (c) 2019-2020 CodeIgniter Foundation

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
</td></tr>
</table>

</details>



<table style="text-align:left">
<tr style="vertical-align:top;">
<th>package</th>
<td>CodeIgniter
</td>
</tr>
<tr style="vertical-align:top;">
<th>author</th>
<td>CodeIgniter Dev Team
</td>
</tr>
<tr style="vertical-align:top;">
<th>copyright</th>
<td>2019-2020 CodeIgniter Foundation
</td>
</tr>
<tr style="vertical-align:top;">
<th>license</th>
<td><a href="https://opensource.org/licenses/MIT">https://opensource.org/licenses/MIT</a>	MIT License
</td>
</tr>
<tr style="vertical-align:top;">
<th>link</th>
<td><a href="https://codeigniter.com">https://codeigniter.com</a>

</td>
</tr>
<tr style="vertical-align:top;">
<th>filesource</th>
<td>framework/system/Debug/Exceptions.php
</td>
</tr>
</table>

 

<details>
<summary style="margin-bottom:12px;"><strong>Members</strong></summary>
<table>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Exceptions.md">CodeIgniter\Debug\Exceptions</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Iterator.md">CodeIgniter\Debug\Iterator</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Timer.md">CodeIgniter\Debug\Timer</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar.md">CodeIgniter\Debug\Toolbar</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/BaseCollector.md">CodeIgniter\Debug\Toolbar\Collectors\BaseCollector</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/Config.md">CodeIgniter\Debug\Toolbar\Collectors\Config</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/Database.md">CodeIgniter\Debug\Toolbar\Collectors\Database</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/Events.md">CodeIgniter\Debug\Toolbar\Collectors\Events</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/Files.md">CodeIgniter\Debug\Toolbar\Collectors\Files</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/History.md">CodeIgniter\Debug\Toolbar\Collectors\History</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/Logs.md">CodeIgniter\Debug\Toolbar\Collectors\Logs</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/Routes.md">CodeIgniter\Debug\Toolbar\Collectors\Routes</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/Timers.md">CodeIgniter\Debug\Toolbar\Collectors\Timers</a></td></tr>
<tr><td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Toolbar/Collectors/Views.md">CodeIgniter\Debug\Toolbar\Collectors\Views</a></td></tr>
</table>
</details>



 
 ## Uses

<table style="text-align:left;">
<tr>
<td>
<a href="../../../../../../api/vendor/codeigniter4/framework/system/API/ResponseTrait.md"><strong>CodeIgniter\API\ResponseTrait</strong></a>
</td>
<td>ResponseTrait</td>
</tr>
<tr>
<td>
<a href="../../../../../../api/vendor/codeigniter4/framework/system/Exceptions/PageNotFoundException.md"><strong>CodeIgniter\Exceptions\PageNotFoundException</strong></a>
</td>
<td>PageNotFoundException</td>
</tr>
<tr>
<td>
<a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/IncomingRequest.md"><strong>CodeIgniter\HTTP\IncomingRequest</strong></a>
</td>
<td>IncomingRequest</td>
</tr>
<tr>
<td>
<a href="../../../../../../api/vendor/codeigniter4/framework/system/HTTP/Response.md"><strong>CodeIgniter\HTTP\Response</strong></a>
</td>
<td>Response</td>
</tr>
<tr>
<td>
<strong>Config\Paths</strong>
</td>
<td>Paths</td>
</tr>
<tr>
<td>
<strong>error_reporting</strong>
</td>
<td>error_reporting</td>
</tr>
<tr>
<td>
<strong>ErrorException</strong>
</td>
<td>ErrorException</td>
</tr>
<tr>
<td>
<strong>Throwable</strong>
</td>
<td>Throwable</td>
</tr>
</table>



 
## CodeIgniter\Debug\Exceptions

<table style="text-align:left">
<tr><th>Class</th><td>Exceptions</td></tr>
<tr><th>Fully Qualified Name</th><td>CodeIgniter\Debug\Exceptions</td></tr>
</table>


<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Exceptions manager
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>



### Summary


<table style="text-align:left;">
<tr>
<th>Name</th>
<th>Element</th>
<th>Modifier</th>
<th>Description</th>
</tr>

<tr>
<th><a href="#ob_level"><strong>ob_level</strong></a></th>
<td>prop</td>
<td>
public

</td>
<td>Nesting level of the output buffering mechanism</td>
</tr>
<tr>
<th><a href="#viewPath"><strong>viewPath</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>The path to the directory containing the
cli and html error view directories.</td>
</tr>
<tr>
<th><a href="#config"><strong>config</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>Config for debug exceptions.</td>
</tr>
<tr>
<th><a href="#request"><strong>request</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>The incoming request.</td>
</tr>
<tr>
<th><a href="#response"><strong>response</strong></a></th>
<td>prop</td>
<td>
protected

</td>
<td>The outgoing response.</td>
</tr>

<tr>
<th><a href="#__construct"><strong>__construct</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Constructor.</td>
</tr>
<tr>
<th><a href="#initialize"><strong>initialize</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Responsible for registering the error, exception and shutdown
handling of our application.</td>
</tr>
<tr>
<th><a href="#exceptionHandler"><strong>exceptionHandler</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Catches any uncaught errors and exceptions, including most Fatal errors
(Yay PHP7!). Will log the error, display it if display_errors is on,
and fire an event that allows custom actions to be taken at this point.</td>
</tr>
<tr>
<th><a href="#errorHandler"><strong>errorHandler</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Even in PHP7, some errors make it through to the errorHandler, so
convert these to Exceptions and let the exception handler log it and
display it.</td>
</tr>
<tr>
<th><a href="#shutdownHandler"><strong>shutdownHandler</strong>()</a></th>
<td>method</td>
<td>
public

</td>
<td>Checks to see if any errors have happened during shutdown that
need to be caught and handle them.</td>
</tr>
<tr>
<th><a href="#determineView"><strong>determineView</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Determines the view to display based on the exception thrown,
whether an HTTP or CLI request, etc.</td>
</tr>
<tr>
<th><a href="#render"><strong>render</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Given an exception and status code will display the error to the client.</td>
</tr>
<tr>
<th><a href="#collectVars"><strong>collectVars</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Gathers the variables that will be made available to the view.</td>
</tr>
<tr>
<th><a href="#determineCodes"><strong>determineCodes</strong>()</a></th>
<td>method</td>
<td>
protected

</td>
<td>Determines the HTTP status code and the exit status code for this request.</td>
</tr>
<tr>
<th><a href="#cleanPath"><strong>cleanPath</strong>()</a></th>
<td>method</td>
<td>
public<br>static

</td>
<td>Clean Path</td>
</tr>
<tr>
<th><a href="#describeMemory"><strong>describeMemory</strong>()</a></th>
<td>method</td>
<td>
public<br>static

</td>
<td>Describes memory usage in real-world units. Intended for use
with memory_get_usage, etc.</td>
</tr>
<tr>
<th><a href="#highlightFile"><strong>highlightFile</strong>()</a></th>
<td>method</td>
<td>
public<br>static

</td>
<td>Creates a syntax-highlighted version of a PHP file.</td>
</tr>

</table>





### Properties


<hr>

#### $ob_level

```php
public $ob_level;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Nesting level of the output buffering mechanism
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>int
</td>
</tr>
</table>


<hr>

#### $viewPath

```php
protected $viewPath;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
The path to the directory containing the
cli and html error view directories.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>string
</td>
</tr>
</table>


<hr>

#### $config

```php
protected $config;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Config for debug exceptions.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>\Config\Exceptions
</td>
</tr>
</table>


<hr>

#### $request

```php
protected $request;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
The incoming request.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>\CodeIgniter\HTTP\IncomingRequest
</td>
</tr>
</table>


<hr>

#### $response

```php
protected $response;
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
The outgoing response.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>




<table>
<tr>
<th style="vertical-align:top;">var</th>
<td>\CodeIgniter\HTTP\Response
</td>
</tr>
</table>







### Methods


<hr>

#### __construct()

```php
public function __construct(\Config\Exceptions $config, IncomingRequest $request, Response $response)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Constructor.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$config</code></td>
<td><em>\Config\Exceptions
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$request</code></td>
<td><em>\CodeIgniter\HTTP\IncomingRequest
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>3.</td>
<td><code>$response</code></td>
<td><em>\CodeIgniter\HTTP\Response
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 11 lines (103 - 113)</small></summary>

```php
public function __construct(\Config\Exceptions $config, IncomingRequest $request, Response $response)
{
	$this->ob_level = ob_get_level();

	$this->viewPath = rtrim($config->errorViewPath, '\\/ ') . DIRECTORY_SEPARATOR;

	$this->config = $config;

	$this->request  = $request;
	$this->response = $response;
}
```

</details>


<hr>

#### initialize()

```php
public function initialize()
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Responsible for registering the error, exception and shutdown
handling of our application.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>










<details>
<summary><small>Source: 12 lines (121 - 132)</small></summary>

```php
public function initialize()
{
	//Set the Exception Handler
	set_exception_handler([$this, 'exceptionHandler']);

	// Set the Error Handler
	set_error_handler([$this, 'errorHandler']);

	// Set the handler for shutdown to catch Parse errors
	// Do we need this in PHP7?
	register_shutdown_function([$this, 'shutdownHandler']);
}
```

</details>


<hr>

#### exceptionHandler()

```php
public function exceptionHandler(Throwable $exception)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Catches any uncaught errors and exceptions, including most Fatal errors
(Yay PHP7!). Will log the error, display it if display_errors is on,
and fire an event that allows custom actions to be taken at this point.
</td></tr>
</table>


</details>



<table style="text-align:left">
<tr style="vertical-align:top;">
<th>codeCoverageIgnore</th>
<td>
</td>
</tr>
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$exception</code></td>
<td><em>\Throwable
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 33 lines (145 - 177)</small></summary>

```php
public function exceptionHandler(Throwable $exception)
{
	[
		$statusCode,
		$exitCode,
	] = $this->determineCodes($exception);

	// Log it
	if ($this->config->log === true && ! in_array($statusCode, $this->config->ignoreCodes))
	{
		log_message('critical', $exception->getMessage() . "\n{trace}", [
						'trace' => $exception->getTraceAsString(),
					]);
	}

	if (! is_cli())
	{
		$this->response->setStatusCode($statusCode);
		$header = "HTTP/{$this->request->getProtocolVersion()} {$this->response->getStatusCode()} {$this->response->getReason()}";
		header($header, true, $statusCode);

		if (strpos($this->request->getHeaderLine('accept'), 'text/html') === false)
		{
			$this->respond(ENVIRONMENT === 'development' ? $this->collectVars($exception, $statusCode) : '', $statusCode)->send();

			exit($exitCode);
		}
	}

	$this->render($exception, $statusCode);

	exit($exitCode);
}
```

</details>


<hr>

#### errorHandler()

```php
public function errorHandler(int $severity, string $message, string $file = null, int $line = null)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Even in PHP7, some errors make it through to the errorHandler, so
convert these to Exceptions and let the exception handler log it and
display it.
</td></tr>
</table>

<table>
<tr><td>
This seems to be primarily when a user triggers it with trigger_error().
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$severity</code></td>
<td><em>int
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$message</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>3.</td>
<td><code>$file</code></td>
<td><em>string<br>null
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>4.</td>
<td><code>$line</code></td>
<td><em>int<br>null
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>





<table>
<tr>
<th style="vertical-align:top;">throw</th>
<td>\ErrorException
</td>
</tr>
</table>



<details>
<summary><small>Source: 10 lines (195 - 204)</small></summary>

```php
public function errorHandler(int $severity, string $message, string $file = null, int $line = null)
{
	if (! (error_reporting() & $severity))
	{
		return;
	}

	// Convert it to an exception and pass it along.
	throw new ErrorException($message, 0, $severity, $file, $line);
}
```

</details>


<hr>

#### shutdownHandler()

```php
public function shutdownHandler()
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Checks to see if any errors have happened during shutdown that
need to be caught and handle them.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>










<details>
<summary><small>Source: 16 lines (212 - 227)</small></summary>

```php
public function shutdownHandler()
{
	$error = error_get_last();

	// If we've got an error that hasn't been displayed, then convert
	// it to an Exception and use the Exception handler to display it
	// to the user.
	if (! is_null($error))
	{
		// Fatal Error?
		if (in_array($error['type'], [E_ERROR, E_CORE_ERROR, E_COMPILE_ERROR, E_PARSE]))
		{
			$this->exceptionHandler(new ErrorException($error['message'], $error['type'], 0, $error['file'], $error['line']));
		}
	}
}
```

</details>


<hr>

#### determineView()

```php
protected function determineView(Throwable $exception, string $template_path) : string
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Determines the view to display based on the exception thrown,
whether an HTTP or CLI request, etc.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$exception</code></td>
<td><em>\Throwable
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$template_path</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 25 lines (240 - 264)</small></summary>

```php
protected function determineView(Throwable $exception, string $template_path): string
{
	// Production environments should have a custom exception file.
	$view          = 'production.php';
	$template_path = rtrim($template_path, '\\/ ') . DIRECTORY_SEPARATOR;

	if (str_ireplace(['off', 'none', 'no', 'false', 'null'], '', ini_get('display_errors')))
	{
		$view = 'error_exception.php';
	}

	// 404 Errors
	if ($exception instanceof PageNotFoundException)
	{
		return 'error_404.php';
	}

	// Allow for custom views based upon the status code
	if (is_file($template_path . 'error_' . $exception->getCode() . '.php'))
	{
		return 'error_' . $exception->getCode() . '.php';
	}

	return $view;
}
```

</details>


<hr>

#### render()

```php
protected function render(Throwable $exception, int $statusCode)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Given an exception and status code will display the error to the client.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$exception</code></td>
<td><em>\Throwable
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$statusCode</code></td>
<td><em>int
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>








<details>
<summary><small>Source: 39 lines (274 - 312)</small></summary>

```php
protected function render(Throwable $exception, int $statusCode)
{
	// Determine possible directories of error views
	$path    = $this->viewPath;
	$altPath = rtrim((new Paths())->viewDirectory, '\\/ ') . DIRECTORY_SEPARATOR . 'errors' . DIRECTORY_SEPARATOR;

	$path    .= (is_cli() ? 'cli' : 'html') . DIRECTORY_SEPARATOR;
	$altPath .= (is_cli() ? 'cli' : 'html') . DIRECTORY_SEPARATOR;

	// Determine the views
	$view    = $this->determineView($exception, $path);
	$altView = $this->determineView($exception, $altPath);

	// Check if the view exists
	if (is_file($path . $view))
	{
		$viewFile = $path . $view;
	}
	elseif (is_file($altPath . $altView))
	{
		$viewFile = $altPath . $altView;
	}

	// Prepare the vars
	$vars = $this->collectVars($exception, $statusCode);
	extract($vars);

	// Render it
	if (ob_get_level() > $this->ob_level + 1)
	{
		ob_end_clean();
	}

	ob_start();
	include $viewFile;
	$buffer = ob_get_contents();
	ob_end_clean();
	echo $buffer;
}
```

</details>


<hr>

#### collectVars()

```php
protected function collectVars(Throwable $exception, int $statusCode) : array
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Gathers the variables that will be made available to the view.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$exception</code></td>
<td><em>\Throwable
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$statusCode</code></td>
<td><em>int
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>array
</td>
</tr>
</table>





<details>
<summary><small>Source: 12 lines (324 - 335)</small></summary>

```php
protected function collectVars(Throwable $exception, int $statusCode): array
{
	return [
		'title'   => get_class($exception),
		'type'    => get_class($exception),
		'code'    => $statusCode,
		'message' => $exception->getMessage() ?? '(null)',
		'file'    => $exception->getFile(),
		'line'    => $exception->getLine(),
		'trace'   => $exception->getTrace(),
	];
}
```

</details>


<hr>

#### determineCodes()

```php
protected function determineCodes(Throwable $exception) : array
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Determines the HTTP status code and the exit status code for this request.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$exception</code></td>
<td><em>\Throwable
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>array
</td>
</tr>
</table>





<details>
<summary><small>Source: 23 lines (344 - 366)</small></summary>

```php
protected function determineCodes(Throwable $exception): array
{
	$statusCode = abs($exception->getCode());

	if ($statusCode < 100 || $statusCode > 599)
	{
		$exitStatus = $statusCode + EXIT__AUTO_MIN; // 9 is EXIT__AUTO_MIN
		if ($exitStatus > EXIT__AUTO_MAX) // 125 is EXIT__AUTO_MAX
		{
			$exitStatus = EXIT_ERROR; // EXIT_ERROR
		}
		$statusCode = 500;
	}
	else
	{
		$exitStatus = 1; // EXIT_ERROR
	}

	return [
		$statusCode ?? 500,
		$exitStatus,
	];
}
```

</details>


<hr>

#### cleanPath()

```php
public static function cleanPath(string $file) : string
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Clean Path
</td></tr>
</table>

<table>
<tr><td>
This makes nicer looking paths for the error output.
</td></tr>
</table>

</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$file</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 20 lines (382 - 401)</small></summary>

```php
public static function cleanPath(string $file): string
{
	switch (true)
	{
		case strpos($file, APPPATH) === 0:
			$file = 'APPPATH' . DIRECTORY_SEPARATOR . substr($file, strlen(APPPATH));
			break;
		case strpos($file, SYSTEMPATH) === 0:
			$file = 'SYSTEMPATH' . DIRECTORY_SEPARATOR . substr($file, strlen(SYSTEMPATH));
			break;
		case strpos($file, FCPATH) === 0:
			$file = 'FCPATH' . DIRECTORY_SEPARATOR . substr($file, strlen(FCPATH));
			break;
		case defined('VENDORPATH') && strpos($file, VENDORPATH) === 0:
			$file = 'VENDORPATH' . DIRECTORY_SEPARATOR . substr($file, strlen(VENDORPATH));
			break;
	}

	return $file;
}
```

</details>


<hr>

#### describeMemory()

```php
public static function describeMemory(int $bytes) : string
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Describes memory usage in real-world units. Intended for use
with memory_get_usage, etc.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$bytes</code></td>
<td><em>
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 13 lines (413 - 425)</small></summary>

```php
public static function describeMemory(int $bytes): string
{
	if ($bytes < 1024)
	{
		return $bytes . 'B';
	}
	else if ($bytes < 1048576)
	{
		return round($bytes / 1024, 2) . 'KB';
	}

	return round($bytes / 1048576, 2) . 'MB';
}
```

</details>


<hr>

#### highlightFile()

```php
public static function highlightFile(string $file, int $lineNumber, int $lines = 15)
```

<details>
<summary style="margin-bottom:12px;"><strong>Description</strong></summary>

<table>
<tr><td>
Creates a syntax-highlighted version of a PHP file.
</td></tr>
</table>


</details>



<table style="text-align:left">
</table>


**Params**

<table>
<thead>
<tr>
<th>#</th>
<th>Variable</th>
<th>Type</th>
<th>Variadic</th>
<th>Description</th>
</tr>
</thead>
<tbody>

<tr>
<td>1.</td>
<td><code>$file</code></td>
<td><em>string
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>2.</td>
<td><code>$lineNumber</code></td>
<td><em>int
</em></td>
<td>false</td>
<td></td>
</tr>

<tr>
<td>3.</td>
<td><code>$lines</code></td>
<td><em>int
</em></td>
<td>false</td>
<td></td>
</tr>


</tbody>
</table>



<table>
<tr>
<th style="vertical-align:top;">return</th>
<td>bool<br>string
</td>
</tr>
</table>





<details>
<summary><small>Source: 73 lines (438 - 510)</small></summary>

```php
public static function highlightFile(string $file, int $lineNumber, int $lines = 15)
{
	if (empty($file) || ! is_readable($file))
	{
		return false;
	}

	// Set our highlight colors:
	if (function_exists('ini_set'))
	{
		ini_set('highlight.comment', '#767a7e; font-style: italic');
		ini_set('highlight.default', '#c7c7c7');
		ini_set('highlight.html', '#06B');
		ini_set('highlight.keyword', '#f1ce61;');
		ini_set('highlight.string', '#869d6a');
	}

	try
	{
		$source = file_get_contents($file);
	}
	catch (Throwable $e)
	{
		return false;
	}

	$source = str_replace(["\r\n", "\r"], "\n", $source);
	$source = explode("\n", highlight_string($source, true));
	$source = str_replace('<br />', "\n", $source[1]);

	$source = explode("\n", str_replace("\r\n", "\n", $source));

	// Get just the part to show
	$start = $lineNumber - (int) round($lines / 2);
	$start = $start < 0 ? 0 : $start;

	// Get just the lines we need to display, while keeping line numbers...
	$source = array_splice($source, $start, $lines, true);

	// Used to format the line number in the source
	$format = '% ' . strlen(sprintf('%s', $start + $lines)) . 'd';

	$out = '';
	// Because the highlighting may have an uneven number
	// of open and close span tags on one line, we need
	// to ensure we can close them all to get the lines
	// showing correctly.
	$spans = 1;

	foreach ($source as $n => $row)
	{
		$spans += substr_count($row, '<span') - substr_count($row, '</span');
		$row    = str_replace(["\r", "\n"], ['', ''], $row);

		if (($n + $start + 1) === $lineNumber)
		{
			preg_match_all('#<[^>]+>#', $row, $tags);
			$out .= sprintf("<span class='line highlight'><span class='number'>{$format}</span> %s\n</span>%s", $n + $start + 1, strip_tags($row), implode('', $tags[0])
			);
		}
		else
		{
			$out .= sprintf('<span class="line"><span class="number">' . $format . '</span> %s', $n + $start + 1, $row) . "\n";
		}
	}

	if ($spans > 0)
	{
		$out .= str_repeat('</span>', $spans);
	}

	return '<pre><code>' . $out . '</code></pre>';
}
```

</details>





 


 
  




<hr>

<table>
<tr>
<td style="width:100%"><em>framework/system/Debug/Exceptions.php</em></td>
<td><a href="../../../../../../api/index.md">index</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Database/Seeder.md">prev</a></td>
<td><a href="../../../../../../api/vendor/codeigniter4/framework/system/Debug/Iterator.md">next</a></td>
<td><a href="#">top</a></td></tr>
</table>




<div style="text-align:right;">

<small>_Generated at **2020-08-14 07:35:11**_ *([EnixApp](https://github.com/enix-app) - [ApiDoc](https://github.com/enix-app/apidoc))*</small>
</div>